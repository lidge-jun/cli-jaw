<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¦ Claw Agent</title>
    <link rel="stylesheet" href="/css/variables.css">
    <link rel="stylesheet" href="/css/layout.css">
    <link rel="stylesheet" href="/css/chat.css">
    <link rel="stylesheet" href="/css/sidebar.css">
    <link rel="stylesheet" href="/css/modals.css">
    <link rel="modulepreload" href="/js/state.js">
    <link rel="modulepreload" href="/js/ws.js">
    <link rel="modulepreload" href="/js/ui.js">
</head>

<body>
    <!-- Left Sidebar -->
    <div class="sidebar-left">
        <div class="logo">ğŸ¦ CLAW</div>

        <div>
            <div class="section-title">Status</div>
            <span class="status-badge status-idle" id="statusBadge">âš¡ idle</span>
        </div>

        <div>
            <div class="section-title">Memory</div>
            <button class="sidebar-hb-btn" id="memorySidebarBtn">ğŸ§  Memory (0)</button>
        </div>

        <div>
            <div class="section-title">Stats</div>
            <p class="stat" id="statMsgs">Messages: 0</p>
        </div>

        <button class="btn-clear">/clear</button>
        <button class="sidebar-hb-btn" id="hbSidebarBtn">ğŸ’“ Heartbeat (0)</button>
    </div>

    <!-- Chat Area -->
    <div class="chat-area" style="position:relative">
        <div class="drag-overlay" id="dragOverlay">ğŸ“ íŒŒì¼ì„ ì—¬ê¸°ì— ë“œëí•˜ì„¸ìš”</div>
        <div class="chat-header">ğŸ¦ Claw Agent â— <span id="headerCli">claude</span></div>
        <div class="chat-messages" id="chatMessages"></div>
        <div class="typing-indicator" id="typingIndicator">
            <span class="label">ğŸ¦ ì‘ë‹µ ì¤‘</span>
            <span class="typing-dot"></span>
            <span class="typing-dot"></span>
            <span class="typing-dot"></span>
        </div>
        <div class="file-preview" id="filePreview">
            <span id="filePreviewName"></span>
            <img id="filePreviewImg" src="" alt="">
            <button class="remove">âœ•</button>
        </div>
        <div class="chat-input-area">
            <button class="btn-attach" title="íŒŒì¼ ì²¨ë¶€">ğŸ“</button>
            <input type="file" id="fileInput" hidden
                accept="image/*,.pdf,.txt,.md,.js,.py,.json,.csv,.html,.css,.ts,.tsx,.jsx">
            <textarea class="chat-input" id="chatInput" rows="1" placeholder="ë©”ì‹œì§€ ì…ë ¥..."></textarea>
            <button class="btn-send" id="btnSend">â¤</button>
        </div>
    </div>

    <!-- Right Sidebar (Tabbed) -->
    <div class="sidebar-right">
        <div class="tab-bar">
            <button class="tab-btn active">ğŸ¤– Agents</button>
            <button class="tab-btn">ğŸ“¦ Skills</button>
            <button class="tab-btn">ğŸ”§ Settings</button>
        </div>
        <div class="sidebar-save-bar">
            <button class="btn-save">Save</button>
        </div>

        <!-- Agents Tab -->
        <div id="tabAgents" class="tab-content active">
            <div>
                <label>Active CLI</label>
                <select id="selCli">
                    <option value="claude">Claude</option>
                    <option value="codex">Codex</option>
                    <option value="gemini">Gemini</option>
                    <option value="opencode">OpenCode</option>
                </select>
            </div>

            <div>
                <label>Model</label>
                <select id="selModel"></select>
            </div>
            <div>
                <label>Effort</label>
                <select id="selEffort">
                    <option value="">â€” none</option>
                    <option value="low">ğŸŸ¢ low</option>
                    <option value="medium" selected>ğŸŸ¡ medium</option>
                    <option value="high">ğŸ”´ high</option>
                </select>
            </div>

            <div>
                <label>Permissions</label>
                <div class="perm-toggle">
                    <button class="perm-btn" id="permSafe">ğŸ”’ Safe</button>
                    <button class="perm-btn active" id="permAuto">âš¡ Auto</button>
                </div>
            </div>

            <div>
                <label>Working Directory</label>
                <input type="text" id="inpCwd" value="~/">
            </div>

            <hr style="border:none;border-top:1px solid var(--border);margin:4px 0">

            <div style="display:flex;justify-content:space-between;align-items:center">
                <div class="section-title">Sub Agents</div>
                <button class="btn-clear" style="margin:0;padding:4px 10px;font-size:11px" data-action="addEmployee">+
                    Add</button>
            </div>
            <div id="employeesList">
                <div style="color:var(--text-dim);font-size:11px">No agents yet</div>
            </div>
        </div>

        <!-- Skills Tab -->
        <div id="tabSkills" class="tab-content">
            <div style="display:flex;gap:6px;flex-wrap:wrap">
                <button class="skill-filter active" data-filter="all">ì „ì²´</button>
                <button class="skill-filter" data-filter="installed">ğŸ“¦ ì„¤ì¹˜ë¨</button>
                <button class="skill-filter" data-filter="productivity">ğŸ“ ìƒì‚°ì„±</button>
                <button class="skill-filter" data-filter="communication">ğŸ“§ ì»¤ë®¤</button>
                <button class="skill-filter" data-filter="devtools">ğŸ”§ ê°œë°œ</button>
                <button class="skill-filter" data-filter="ai-media">ğŸ¤– AI</button>
                <button class="skill-filter" data-filter="utility">ğŸŒ ìœ í‹¸</button>
                <button class="skill-filter" data-filter="smarthome">ğŸ  í™ˆ</button>
                <button class="skill-filter" data-filter="other">ğŸ“‚ ê¸°íƒ€</button>
            </div>
            <div style="font-size:10px;color:var(--text-dim)" id="skillsCount">ë¡œë”© ì¤‘...</div>
            <div id="skillsList"></div>
        </div>

        <!-- Settings Tab -->
        <div id="tabSettings" class="tab-content">
            <button class="btn-clear" style="width:100%;margin:0;padding:8px;font-size:12px" data-action="openPrompt">âœï¸
                ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ í¸ì§‘</button>
            <!-- Telegram Bot -->
            <div class="settings-group">
                <h4>ğŸ“¬ Telegram</h4>
                <div class="settings-row">
                    <label>Enabled</label>
                    <div>
                        <button id="tgOff" class="perm-btn active">Off</button>
                        <button id="tgOn" class="perm-btn">On</button>
                    </div>
                </div>
                <div class="settings-row sub-row">
                    <label>Bot Token</label>
                    <input type="password" id="tgToken" placeholder="123456:ABC-DEF..."
                        style="width:100%;font-size:11px;padding:4px">
                </div>
                <div class="settings-row sub-row">
                    <label>Allowed Chat IDs</label>
                    <input type="text" id="tgChatIds" placeholder="ì½¤ë§ˆ êµ¬ë¶„ (ë¹„ì›Œë‘ë©´ ì „ì²´ í—ˆìš©)"
                        style="width:100%;font-size:11px;padding:4px">
                </div>
            </div>

            <!-- Per-CLI Models -->
            <div class="settings-group">
                <h4>ğŸŸ£ Claude</h4>
                <div class="settings-row">
                    <label>Model</label>
                    <select id="modelClaude">
                        <option selected>claude-sonnet-4-6</option>
                        <option>claude-opus-4-6</option>
                        <option>claude-sonnet-4-6[1m]</option>
                        <option>claude-opus-4-6[1m]</option>
                        <option>claude-haiku-4-5-20251001</option>
                        <option value="__custom__">âœï¸ ì§ì ‘ ì…ë ¥...</option>
                    </select>
                    <input type="text" id="customModelClaude" class="custom-model-input" placeholder="model ID ì…ë ¥"
                        style="display:none">
                </div>
                <div class="settings-row sub-row">
                    <label>Effort</label>
                    <select id="effortClaude">
                        <option value="low">ğŸŸ¢ low</option>
                        <option value="medium" selected>ğŸŸ¡ medium</option>
                        <option value="high">ğŸ”´ high</option>
                    </select>
                </div>
            </div>

            <div class="settings-group">
                <h4>ğŸŸ¢ Codex</h4>
                <div class="settings-row">
                    <label>Model</label>
                    <select id="modelCodex">
                        <option selected>gpt-5.3-codex</option>
                        <option>gpt-5.3-codex-spark</option>
                        <option>gpt-5.2-codex</option>
                        <option>gpt-5.1-codex-max</option>
                        <option>gpt-5.1-codex-mini</option>
                        <option value="__custom__">âœï¸ ì§ì ‘ ì…ë ¥...</option>
                    </select>
                    <input type="text" id="customModelCodex" class="custom-model-input" placeholder="model ID ì…ë ¥"
                        style="display:none">
                </div>
                <div class="settings-row sub-row">
                    <label>Effort</label>
                    <select id="effortCodex">
                        <option value="low">ğŸŸ¢ low</option>
                        <option value="medium" selected>ğŸŸ¡ medium</option>
                        <option value="high">ğŸŸ  high</option>
                        <option value="xhigh">ğŸ”´ xhigh</option>
                    </select>
                </div>
            </div>

            <div class="settings-group">
                <h4>ğŸ”µ Gemini</h4>
                <div class="settings-row">
                    <label>Model</label>
                    <select id="modelGemini">
                        <option>gemini-3.0-pro-preview</option>
                        <option selected>gemini-2.5-pro</option>
                        <option>gemini-3.1-pro-preview</option>
                        <option>gemini-3-flash-preview</option>
                        <option>gemini-2.5-flash</option>
                        <option value="__custom__">âœï¸ ì§ì ‘ ì…ë ¥...</option>
                    </select>
                    <input type="text" id="customModelGemini" class="custom-model-input" placeholder="model ID ì…ë ¥"
                        style="display:none">
                </div>
            </div>

            <div class="settings-group">
                <h4>ğŸŸ  OpenCode</h4>
                <div class="settings-row">
                    <label>Model</label>
                    <select id="modelOpencode">
                        <option>github-copilot/claude-sonnet-4.5</option>
                        <option>github-copilot/claude-opus-4.6</option>
                        <option>github-copilot/gpt-5</option>
                        <option>github-copilot/gemini-2.5-pro</option>
                        <option>opencode/big-pickle</option>
                        <option>opencode/GLM-5 Free</option>
                        <option>opencode/MiniMax M2.5 Free</option>
                        <option>opencode/Kimi K2.5 Free</option>
                        <option>opencode/GPT 5 Nano Free</option>
                        <option>opencode/Grok Code Fast 1 Free</option>
                        <option value="__custom__">âœï¸ ì§ì ‘ ì…ë ¥...</option>
                    </select>
                    <input type="text" id="customModelOpencode" class="custom-model-input" placeholder="model ID ì…ë ¥"
                        style="display:none">
                </div>
                <div class="settings-row sub-row">
                    <label>Effort</label>
                    <select id="effortOpencode">
                        <option value="">â€” none</option>
                        <option value="minimal">ğŸŸ¢ minimal</option>
                        <option value="low">ğŸŸ¡ low</option>
                        <option value="high">ğŸŸ  high</option>
                        <option value="max">ğŸ”´ max</option>
                    </select>
                </div>
            </div>

            <!-- MCP Servers -->
            <div class="settings-group">
                <h4>ğŸ”Œ MCP Servers</h4>
                <div id="mcpServerList" style="font-size:11px;color:var(--text-dim);padding:4px 0">
                    Loading...
                </div>
                <button class="btn-clear" style="width:100%;margin:4px 0;padding:6px;font-size:11px"
                    data-action="syncMcp">ğŸ”„ Sync to all CLIs</button>
                <button class="btn-clear" style="width:100%;margin:0 0 4px;padding:6px;font-size:11px"
                    data-action="installMcp">ğŸ“¦ Install Globally (npm i -g)</button>
                <div id="mcpSyncResult" style="font-size:10px;color:var(--text-dim);padding:2px 0;display:none"></div>
            </div>

            <!-- CLI Status -->
            <div style="margin-top:12px">
                <div class="section-title">CLI STATUS</div>
                <div id="cliStatusList" style="margin-top:4px">
                    <div style="color:var(--text-dim);font-size:11px">íƒ­ ì§„ì… ì‹œ ë¡œë“œë¨</div>
                </div>
                <div style="display:flex;gap:6px;margin-top:8px;align-items:center">
                    <button class="btn-clear" style="margin:0;flex:1;padding:6px" data-action="refreshCli">ğŸ”„
                        Refresh</button>
                    <select id="cliStatusInterval"
                        style="font-size:11px;padding:4px;background:var(--surface);color:var(--text);border:1px solid var(--border);border-radius:4px">
                        <option value="60">1ë¶„</option>
                        <option value="300" selected>5ë¶„</option>
                        <option value="600">10ë¶„</option>
                        <option value="0">ìˆ˜ë™</option>
                    </select>
                </div>
            </div>
        </div>
    </div>

    <!-- Prompt Modal -->
    <div class="modal-overlay" id="promptModal">
        <div class="modal-box">
            <div class="modal-header">
                <span>System Prompt (A-2)</span>
                <button data-action="closePrompt"
                    style="background:none;border:none;color:var(--text-dim);cursor:pointer;font-size:16px">âœ•</button>
            </div>
            <textarea class="modal-textarea" id="modalPromptEditor"></textarea>
            <div class="modal-footer">
                <button class="btn-clear" style="margin:0;padding:6px 16px" data-action="cancelPrompt">ì·¨ì†Œ</button>
                <button class="btn-save" data-action="savePrompt">ì €ì¥</button>
            </div>
        </div>
    </div>

    <!-- Heartbeat Jobs Modal -->
    <div class="modal-overlay" id="heartbeatModal">
        <div class="modal-box" style="max-height:80vh;overflow-y:auto">
            <div class="modal-header">
                <span>ğŸ’“ Heartbeat Jobs</span>
                <button data-action="closeHeartbeat"
                    style="background:none;border:none;color:var(--text-dim);cursor:pointer;font-size:16px">âœ•</button>
            </div>
            <div id="hbJobsList" style="padding:12px"></div>
            <div style="padding:0 12px 12px">
                <button class="hb-add" data-action="addHeartbeat">+ ìƒˆ í•˜íŠ¸ë¹„íŠ¸ ì¶”ê°€</button>
            </div>
        </div>
    </div>

    <!-- Memory Modal -->
    <div class="modal-overlay" id="memoryModal">
        <div class="modal-box" style="max-height:80vh;overflow-y:auto">
            <div class="modal-header">
                <span>ğŸ§  Memory</span>
                <button data-action="closeMemory"
                    style="background:none;border:none;color:var(--text-dim);cursor:pointer;font-size:16px">âœ•</button>
            </div>
            <div style="display:flex;border-bottom:1px solid var(--border);padding:0 12px">
                <button class="mem-tab active" id="memTabBtnSettings"
                    style="padding:6px 12px;border:none;background:none;color:var(--text);cursor:pointer;font-size:12px;border-bottom:2px solid transparent">âš™ï¸
                    Settings</button>
                <button class="mem-tab" id="memTabBtnFiles"
                    style="padding:6px 12px;border:none;background:none;color:var(--text-dim);cursor:pointer;font-size:12px;border-bottom:2px solid transparent">ğŸ“‚
                    Files</button>
            </div>
            <div id="memTabSettings" style="padding:12px">
                <div class="settings-row"><label>Enabled</label>
                    <div>
                        <button id="memOff" class="perm-btn">Off</button>
                        <button id="memOn" class="perm-btn active">On</button>
                    </div>
                </div>
                <div class="settings-row"><label>Flush Every</label>
                    <select id="memFlushEvery"
                        style="font-size:11px;padding:4px;background:var(--surface);color:var(--text);border:1px solid var(--border);border-radius:4px">
                        <option value="5">5 QA</option>
                        <option value="10" selected>10 QA</option>
                        <option value="20">20 QA</option>
                        <option value="50">50 QA</option>
                    </select>
                </div>
                <div class="settings-row"><label>CLI</label>
                    <select id="memCli"
                        style="font-size:11px;padding:4px;background:var(--surface);color:var(--text);border:1px solid var(--border);border-radius:4px">
                        <option value="">(active CLI)</option>
                        <option>claude</option>
                        <option>codex</option>
                        <option>gemini</option>
                        <option>opencode</option>
                    </select>
                </div>
                <div class="settings-row"><label>Model</label>
                    <select id="memModel"
                        style="font-size:11px;padding:4px;background:var(--surface);color:var(--text);border:1px solid var(--border);border-radius:4px">
                        <option value="">(CLI default)</option>
                        <option>claude-haiku-4-5-20251001</option>
                        <option>claude-sonnet-4-5-20250929</option>
                        <option>gemini-2.5-flash</option>
                        <option>gpt-5.3-codex-spark</option>
                    </select>
                </div>
                <div class="settings-row"><label>Save Path</label>
                    <span id="memPath"
                        style="font-size:10px;color:var(--text-dim);font-family:monospace;word-break:break-all"></span>
                </div>
                <div class="settings-row"><label>Retention</label>
                    <select id="memRetention"
                        style="font-size:11px;padding:4px;background:var(--surface);color:var(--text);border:1px solid var(--border);border-radius:4px">
                        <option value="7">7 days</option>
                        <option value="30" selected>30 days</option>
                        <option value="90">90 days</option>
                        <option value="0">forever</option>
                    </select>
                </div>
                <div
                    style="margin-top:8px;padding:6px;background:var(--bg);border-radius:4px;font-size:11px;color:var(--text-dim)">
                    ğŸ’¡ Counter: <span id="memCounter">0</span> / <span id="memThreshold">10</span> responses until next
                    flush
                </div>
            </div>
            <div id="memTabFiles" style="padding:12px;display:none">
                <div id="memFilesList"></div>
            </div>
        </div>
    </div>

    <script type="module" src="/js/main.js"></script>
</body>

</html>